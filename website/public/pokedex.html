<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/public/style/style.css">
    <link rel="icon" href="../static/images/Poké_Ball_icon.svg.png"  type="image/x-icon">
    <title>Pokedex</title>
</head>
<body>
    <h1>Pokédex!</h1>
    <label class="toggle-switch">
        <input type="checkbox"/>
        <span class="slider"></span>
    </label>
    <table id="pokedex"></table>

    <script>
        const checkbox = document.getElementById('toggle-switch');
        var selectedPokedex
        
        //checkbox.addEventListener('change', () => {
        //if(selectedPokedex)
        fetch('/api/pokedex?req_type=pkdx')
            .then(response => response.json())
            .then(data => {
                const pokedexList = document.getElementById('pokedex');

                data.forEach(pokemon => {
                    const listItem = document.createElement('tr');

                    const img = document.createElement('img');
                    img.src = `../static/images/sprites/${pokemon.pokedex_nbr}.png`;
                    img.alt = "Pokémon sprite"; 
                    img.style.width = "200px";
                    img.style.height = "200px";
                    
                    img.onerror = function() {
                        this.src = "../static/images/sub.png"
                        this.onerror = null;
                    };

                    const link = document.createElement('a');
                    link.href = `/pokemon?pokemon_number=${pokemon.pokedex_nbr}`;
                    link.textContent = `${pokemon.name}`;

                    const imageCell = document.createElement('td');
                    const nameCell = document.createElement('td');
                    imageCell.style.textAlign = "center";
                    imageCell.appendChild(img);
                    nameCell.appendChild(link);
                    
                    listItem.appendChild(imageCell);
                    listItem.appendChild(nameCell);

                    pokedexList.appendChild(listItem)
                });
            })
            .catch(error => console.error('Error fetching messages : ', error));
    </script>
</body>
</html>
